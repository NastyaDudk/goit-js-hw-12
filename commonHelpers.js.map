{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport Axios from 'axios';\n\nconst galleryEl = document.getElementById('.gallery-el');\nconst loadMoreBtn = document.getElementById('.load-more');\nconst loaderEl = document.querySelector('.loader');\n\nconst PIXABAY_URL = 'https://pixabay.com/api/';\nconst PIXABAY_API_KEY = '2208122-c38407f0c226da94dd817bfa0';\nconst DEBOUNCE_DELAY = 100;\nconst POST_PER_PAGE = 15;\nlet currentPage = 1;\n\nsearchForm.addEventListener(\n  'input',\n  debounce(event => {\n    const searchValue = event.target.value;\n    localStorage.setItem('search-term', searchValue.trim());\n  }, DEBOUNCE_DELAY)\n);\n\nsubmitBtn.addEventListener('click', event => {\n  event.preventDefault();\n  const savedSearch = localStorage.getItem('search-term');\n  if (savedSearch === null || savedSearch === '') {\n    Notiflix.Notify.info('Please type something in the search input.');\n    return;\n  }\n  currentPage = 1;\n  fetchImages(savedSearch, currentPage);\n});\n\nconst fetchImages = async (searchValue, currentPage) => {\n  let galleryMarkup = '';\n  let params = new URLSearchParams({\n    key: PIXABAY_API_KEY,\n    q: searchValue,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: POST_PER_PAGE,\n  });\n\n  try {\n    const response = await axios.get(\n      `${PIXABAY_URL}?${params}&page=${currentPage}`\n    );\n    // console.log('response: ', response);\n    const imagesArray = response.data.hits;\n    // console.log('imagesArray: ', imagesArray);\n    if (searchValue === '') {\n    }\n    if (imagesArray.length === 0) {\n      Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n\n      return;\n    }\n\n    loadMoreBtn.style.display = 'block';\n    footer.style.display = 'flex';\n\n    galleryMarkup = imagesArray\n      .map(image => {\n        return `\n        <div class=\"photo-card\">\n          <div class =\"thumb\">\n            <img class=\"img\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n          </div>\n          <div class=\"info\">\n            <p class=\"info-item\">\n              <b>Likes</b>\n              ${image.likes}\n            </p>\n            <p class=\"info-item\">\n              <b>Views</b>\n              ${image.views}\n            </p>\n            <p class=\"info-item\">\n              <b>Comments</b>\n              ${image.comments}\n            </p>\n            <p class=\"info-item\">\n              <b>Downloads</b>\n              ${image.downloads}\n            </p>\n          </div>\n        </div>\n      `;\n      })\n      .join('');\n\n    gallery.innerHTML = galleryMarkup;\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nconst fetchNewImages = async (searchValue, currentPage) => {\n  let galleryMarkup = '';\n  let params = new URLSearchParams({\n    key: PIXABAY_API_KEY,\n    q: searchValue,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: POST_PER_PAGE,\n  });\n\n  try {\n    const response = await axios.get(\n      `${PIXABAY_URL}?${params}&page=${currentPage}`\n    );\n    // console.log('response: ', response);\n    const imagesArray = response.data.hits;\n    // console.log('imagesArray: ', imagesArray);\n    if (imagesArray.length === 0) {\n      Notiflix.Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n\n    galleryMarkup = imagesArray\n      .map(image => {\n        return `\n        <div class=\"photo-card\">\n          <div class =\"thumb\">\n            <img class=\"img\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n          </div>\n          <div class=\"info\">\n            <p class=\"info-item\">\n              <b>Likes</b>\n              ${image.likes}\n            </p>\n            <p class=\"info-item\">\n              <b>Views</b>\n              ${image.views}\n            </p>\n            <p class=\"info-item\">\n              <b>Comments</b>\n              ${image.comments}\n            </p>\n            <p class=\"info-item\">\n              <b>Downloads</b>\n              ${image.downloads}\n            </p>\n          </div>\n        </div>\n      `;\n      })\n      .join('');\n\n    gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nloadMoreBtn.addEventListener('click', async () => {\n  const searchValue = localStorage.getItem('search-term');\n  currentPage++;\n  let params = new URLSearchParams({\n    key: PIXABAY_API_KEY,\n    q: searchValue,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: POST_PER_PAGE,\n  });\n  try {\n    const response = await axios.get(\n      `${PIXABAY_URL}?${params}&page=${currentPage}`\n    );\n\n    const imagesArray = response.data.hits;\n    const imagesPerPage = POST_PER_PAGE;\n\n    const totalImages = response.data.totalHits;\n    const maxPageNumber = totalImages / imagesPerPage;\n    const maxPageNumberRoundUp = Math.ceil(maxPageNumber);\n    console.log('currentPage: ', currentPage);\n    console.log('maxPageNumber: ', maxPageNumber);\n    console.log('maxPageNumberRoundUp: ', maxPageNumberRoundUp);\n\n    if (currentPage === maxPageNumberRoundUp) {\n      footer.style.display = 'none';\n      loadMoreBtn.style.display = 'none';\n      Notiflix.Notify.info(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n\n    fetchNewImages(searchValue, currentPage);\n  } catch (error) {\n    console.error(error);\n  }\n});\nmorebut.style.display = 'none';\nloadMoreBtn.style.display = 'none';\n"],"names":["loadMoreBtn","PIXABAY_URL","PIXABAY_API_KEY","DEBOUNCE_DELAY","POST_PER_PAGE","currentPage","event","searchValue","savedSearch","fetchImages","galleryMarkup","params","imagesArray","image","error","fetchNewImages","response","imagesPerPage","maxPageNumber","maxPageNumberRoundUp"],"mappings":"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"}