{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport Axios from 'axios';\n\nexport const refs = {\n  galleryEl: document.getElementById('.gallery-el'),\n  submitBtn: document.querySelector(\"[type='submit']\"),\n  loadMoreBtn: document.getElementById('.load-more-btn'),\n  loaderEl: document.querySelector('.loader'),\n  searchForm: document.querySelector('.form'),\n};\n\nlet _page = 1;\nconst limit = 15;\nlet totalPages = 0;\nlet value = '';\nconst simpleLightBox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nrefs.formEl.addEventListener('submit', onFormSubmit);\nloaderHide();\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  refs.galleryEl.innerHTML = '';\n  BtnLoaderHide();\n  value = e.target.elements.valueGallery.value.trim();\n  if (!value) {\n    messageErr(\n      'Sorry, there are no images matching your search query. Please try again!'\n    );\n    return;\n  }\n  if (value !== '') {\n    loaderShow();\n    _page = 1;\n    try {\n      const data = await getUrl();\n      if (data.hits.length >= 1) {\n        loaderHide();\n        renderImages(data.hits);\n        simpleLightBox.refresh();\n        if (data.hits.length < limit) {\n          BtnLoaderHide();\n          messageErr(\"We're sorry, there are no more posts to load\");\n        } else {\n          BtnLoaderShow();\n        }\n      } else {\n        loaderHide();\n        messageErr(\n          'Sorry, there are no images matching your search query. Please try again!'\n        );\n      }\n    } catch (err) {\n      totalPages = 0;\n      checkTotalHits(totalPages);\n    }\n  }\n  e.target.reset();\n}\n\nrefs.btnLoad.addEventListener('click', onBtnLoadClick);\n\nasync function onBtnLoadClick() {\n  _page += 1;\n  loaderShow();\n  const data = await getUrl();\n  renderImages(data.hits);\n  simpleLightBox.refresh();\n  checkTotalHits(data.totalHits);\n  loaderHide();\n  const card = document.querySelector('.card');\n  let rect = 2 * card.getBoundingClientRect().height;\n  window.scrollBy({\n    top: rect,\n    behavior: 'smooth',\n  });\n}\n\nfunction checkTotalHits(totalHits) {\n  totalPages = Math.ceil(totalHits / limit);\n  if (totalPages <= _page) {\n    BtnLoaderHide();\n    messageErr(\"We're sorry, there are no more posts to load\");\n  }\n}\n\nfunction messageErr(message) {\n  return iziToast.error({\n    position: 'topRight',\n    color: 'blue',\n    message: message,\n  });\n}\nfunction loaderShow() {\n  refs.loader.style.visibility = 'visible';\n}\nfunction loaderHide() {\n  refs.loader.style.visibility = 'hidden';\n}\nfunction BtnLoaderShow() {\n  refs.btnLoad.style.visibility = 'visible';\n}\nfunction BtnLoaderHide() {\n  refs.btnLoad.style.visibility = 'hidden';\n}\n\nconst axios = Axios.create({\n  baseURL: 'https://pixabay.com/api/',\n});\nasync function getUrl() {\n  const response = await axios.get('', {\n    params: {\n      key: '42132466-2eec74b8e2a534f613ea758a4',\n      q: value,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: limit,\n      page: _page,\n    },\n  });\n  return response.data;\n}\n"],"names":["refs","_page","limit","totalPages","value","simpleLightBox","SimpleLightbox","onFormSubmit","loaderHide","e","BtnLoaderHide","messageErr","loaderShow","data","getUrl","BtnLoaderShow","checkTotalHits","onBtnLoadClick","rect","totalHits","message","iziToast","axios","Axios"],"mappings":"owBAMO,MAAMA,EAAO,CAClB,UAAW,SAAS,eAAe,aAAa,EAChD,UAAW,SAAS,cAAc,iBAAiB,EACnD,YAAa,SAAS,eAAe,gBAAgB,EACrD,SAAU,SAAS,cAAc,SAAS,EAC1C,WAAY,SAAS,cAAc,OAAO,CAC5C,EAEA,IAAIC,EAAQ,EACZ,MAAMC,EAAQ,GACd,IAAIC,EAAa,EACbC,EAAQ,GACZ,MAAMC,EAAiB,IAAIC,EAAe,aAAc,CACtD,aAAc,MACd,aAAc,GAChB,CAAC,EAEDN,EAAK,OAAO,iBAAiB,SAAUO,CAAY,EACnDC,IAEA,eAAeD,EAAaE,EAAG,CAK7B,GAJAA,EAAE,eAAc,EAChBT,EAAK,UAAU,UAAY,GAC3BU,IACAN,EAAQK,EAAE,OAAO,SAAS,aAAa,MAAM,OACzC,CAACL,EAAO,CACVO,EACE,0EACN,EACI,MACD,CACD,GAAIP,IAAU,GAAI,CAChBQ,IACAX,EAAQ,EACR,GAAI,CACF,MAAMY,EAAO,MAAMC,IACfD,EAAK,KAAK,QAAU,GACtBL,IACA,aAAaK,EAAK,IAAI,EACtBR,EAAe,QAAO,EAClBQ,EAAK,KAAK,OAASX,GACrBQ,IACAC,EAAW,8CAA8C,GAEzDI,MAGFP,IACAG,EACE,0EACV,EAEK,MAAC,CACAR,EAAa,EACba,EAAeb,CAAU,CAC1B,CACF,CACDM,EAAE,OAAO,OACX,CAEAT,EAAK,QAAQ,iBAAiB,QAASiB,CAAc,EAErD,eAAeA,GAAiB,CAC9BhB,GAAS,EACTW,IACA,MAAMC,EAAO,MAAMC,IACnB,aAAaD,EAAK,IAAI,EACtBR,EAAe,QAAO,EACtBW,EAAeH,EAAK,SAAS,EAC7BL,IAEA,IAAIU,EAAO,EADE,SAAS,cAAc,OAAO,EACvB,sBAAqB,EAAG,OAC5C,OAAO,SAAS,CACd,IAAKA,EACL,SAAU,QACd,CAAG,CACH,CAEA,SAASF,EAAeG,EAAW,CACjChB,EAAa,KAAK,KAAKgB,EAAYjB,CAAK,EACpCC,GAAcF,IAChBS,IACAC,EAAW,8CAA8C,EAE7D,CAEA,SAASA,EAAWS,EAAS,CAC3B,OAAOC,EAAS,MAAM,CACpB,SAAU,WACV,MAAO,OACP,QAASD,CACb,CAAG,CACH,CACA,SAASR,GAAa,CACpBZ,EAAK,OAAO,MAAM,WAAa,SACjC,CACA,SAASQ,GAAa,CACpBR,EAAK,OAAO,MAAM,WAAa,QACjC,CACA,SAASe,GAAgB,CACvBf,EAAK,QAAQ,MAAM,WAAa,SAClC,CACA,SAASU,GAAgB,CACvBV,EAAK,QAAQ,MAAM,WAAa,QAClC,CAEA,MAAMsB,EAAQC,EAAM,OAAO,CACzB,QAAS,0BACX,CAAC,EACD,eAAeT,GAAS,CAYtB,OAXiB,MAAMQ,EAAM,IAAI,GAAI,CACnC,OAAQ,CACN,IAAK,qCACL,EAAGlB,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMD,CACP,CACL,CAAG,GACe,IAClB"}