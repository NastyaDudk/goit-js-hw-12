{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export const apiKey = '42175181-9f2e4ea0c75ffabf50c3ef9f9';\n\nif (!apiKey) {\n  console.error(\n    'API key is missing. Please provide the API key in the .env file.'\n  );\n}\n","export function toastSuccess(message) {\n  iziToast.success({\n    title: 'Success',\n    message: message,\n    position: 'topRight',\n  });\n}\n\nexport function toastError(message) {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n    position: 'topRight',\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst galleryContainer = document.querySelector('.gallery');\nconst loaderContainer = document.getElementById('loader');\nconst loadMoreBtn = document.getElementById('load-more');\nconst searchForm = document.getElementById('search-form');\nconst loadingIndicator = document.getElementById('loading-indicator');\n\nimport { apiKey } from './js/pixabay-api';\n\nfunction showLoadMoreBtn(show) {\n  loadMoreBtn.style.display = show ? 'block' : 'none';\n}\n\nimport { toastSuccess, toastError } from './js/render-functions';\n\nlet totalHits = 0;\n\nasync function searchImages(query, page = 1) {\n  const url = `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=15`;\n  try {\n    const response = await axios.get(url);\n    totalHits = response.data.totalHits;\n    return response.data.hits;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    toastError('Failed to fetch images.');\n    throw error;\n  }\n}\n\nasync function scrollToNextGroup() {\n  const cardHeight = galleryContainer\n    .querySelector('.image-card')\n    .getBoundingClientRect().height;\n  window.scrollBy({\n    top: 2 * cardHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet currentImagesCount = 0;\n\nsearchForm.addEventListener('submit', async function (event) {\n  event.preventDefault();\n  showLoadMoreBtn(false);\n  const query = document.getElementById('query').value.trim();\n  if (!query) {\n    iziToast.warning({\n      title: 'Warning',\n      message: 'Please enter a search query.',\n    });\n    return;\n  }\n  try {\n    loaderContainer.style.display = 'block';\n    currentQuery = query;\n    currentPage = 1;\n    const images = await searchImages(query, currentPage);\n    if (images.length > 0) {\n      displayImages(images);\n      toastSuccess(`Was found: ${images.length} images`);\n      initializeLightbox();\n      showLoadMoreBtn(true);\n    } else {\n      galleryContainer.innerHTML = '';\n      toastError(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      showLoadMoreBtn(false);\n    }\n  } finally {\n    loaderContainer.style.display = 'none';\n  }\n});\n\nloadMoreBtn.addEventListener('click', async function () {\n  try {\n    loaderContainer.style.display = 'block';\n    loadingIndicator.style.display = 'block';\n    currentPage++;\n    const images = await searchImages(currentQuery, currentPage);\n    if (images.length > 0) {\n      appendImages(images);\n      toastSuccess(`Loaded additional ${images.length} images`);\n      initializeLightbox();\n      if (images.length < 15) {\n        toastError(\n          'We are sorry, but you have reached the end of search results.'\n        );\n        showLoadMoreBtn(false);\n      }\n\n      scrollToNextGroup();\n    } else {\n      toastError('No more images to load');\n      showLoadMoreBtn(false);\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    toastError('Failed to fetch additional images.');\n  } finally {\n    loaderContainer.style.display = 'none';\n    loadingIndicator.style.display = 'none';\n  }\n});\n\nfunction displayImages(images) {\n  galleryContainer.innerHTML = '';\n  appendImages(images);\n}\n\nfunction appendImages(images) {\n  const fragment = document.createDocumentFragment();\n  images.forEach(image => {\n    const {\n      largeImageURL,\n      webformatURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    } = image;\n    const imageCard = document.createElement('div');\n    imageCard.classList.add('image-card');\n    imageCard.innerHTML = `\n            <a href=\"${largeImageURL}\" data-lightbox=\"image-set\" data-title=\"${tags}\">\n                <img src=\"${webformatURL}\" alt=\"${tags}\">\n                <div class=\"info\">Likes: ${likes}, Views: ${views}, Comments: ${comments}, Downloads: ${downloads}</div>\n            </a>\n        `;\n    fragment.appendChild(imageCard);\n  });\n  galleryContainer.appendChild(fragment);\n\n  currentImagesCount += images.length;\n}\n\nlet lightbox = null;\n\nfunction initializeLightbox() {\n  if (lightbox) {\n    lightbox.destroy();\n  }\n  lightbox = new SimpleLightbox('.gallery a');\n}\n"],"names":["apiKey","toastSuccess","message","toastError","galleryContainer","loaderContainer","loadMoreBtn","searchForm","loadingIndicator","showLoadMoreBtn","show","totalHits","searchImages","query","page","url","response","axios","error","scrollToNextGroup","cardHeight","currentPage","currentQuery","currentImagesCount","event","iziToast","images","displayImages","initializeLightbox","appendImages","fragment","image","largeImageURL","webformatURL","tags","likes","views","comments","downloads","imageCard","lightbox","SimpleLightbox"],"mappings":"owBAAO,MAAMA,EAAS,qCCAf,SAASC,EAAaC,EAAS,CACpC,SAAS,QAAQ,CACf,MAAO,UACP,QAASA,EACT,SAAU,UACd,CAAG,CACH,CAEO,SAASC,EAAWD,EAAS,CAClC,SAAS,MAAM,CACb,MAAO,QACP,QAASA,EACT,SAAU,UACd,CAAG,CACH,CCRA,MAAME,EAAmB,SAAS,cAAc,UAAU,EACpDC,EAAkB,SAAS,eAAe,QAAQ,EAClDC,EAAc,SAAS,eAAe,WAAW,EACjDC,EAAa,SAAS,eAAe,aAAa,EAClDC,EAAmB,SAAS,eAAe,mBAAmB,EAIpE,SAASC,EAAgBC,EAAM,CAC7BJ,EAAY,MAAM,QAAUI,EAAO,QAAU,MAC/C,CAIA,IAAIC,EAAY,EAEhB,eAAeC,EAAaC,EAAOC,EAAO,EAAG,CAC3C,MAAMC,EAAM,gCAAgCf,OAAY,mBACtDa,CACJ,kEAAoEC,gBAClE,GAAI,CACF,MAAME,EAAW,MAAMC,EAAM,IAAIF,CAAG,EACpC,OAAAJ,EAAYK,EAAS,KAAK,UACnBA,EAAS,KAAK,IACtB,OAAQE,EAAP,CACA,cAAQ,MAAM,yBAA0BA,CAAK,EAC7Cf,EAAW,yBAAyB,EAC9Be,CACP,CACH,CAEA,eAAeC,GAAoB,CACjC,MAAMC,EAAahB,EAChB,cAAc,aAAa,EAC3B,sBAAqB,EAAG,OAC3B,OAAO,SAAS,CACd,IAAK,EAAIgB,EACT,KAAM,EACN,SAAU,QACd,CAAG,CACH,CAEA,IAAIC,EAAc,EACdC,EAAe,GACfC,EAAqB,EAEzBhB,EAAW,iBAAiB,SAAU,eAAgBiB,EAAO,CAC3DA,EAAM,eAAc,EACpBf,EAAgB,EAAK,EACrB,MAAMI,EAAQ,SAAS,eAAe,OAAO,EAAE,MAAM,OACrD,GAAI,CAACA,EAAO,CACVY,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,8BACf,CAAK,EACD,MACD,CACD,GAAI,CACFpB,EAAgB,MAAM,QAAU,QAChCiB,EAAeT,EACfQ,EAAc,EACd,MAAMK,EAAS,MAAMd,EAAaC,EAAOQ,CAAW,EAChDK,EAAO,OAAS,GAClBC,EAAcD,CAAM,EACpBzB,EAAa,cAAcyB,EAAO,eAAe,EACjDE,IACAnB,EAAgB,EAAI,IAEpBL,EAAiB,UAAY,GAC7BD,EACE,0EACR,EACMM,EAAgB,EAAK,EAE3B,QAAY,CACRJ,EAAgB,MAAM,QAAU,MACjC,CACH,CAAC,EAEDC,EAAY,iBAAiB,QAAS,gBAAkB,CACtD,GAAI,CACFD,EAAgB,MAAM,QAAU,QAChCG,EAAiB,MAAM,QAAU,QACjCa,IACA,MAAMK,EAAS,MAAMd,EAAaU,EAAcD,CAAW,EACvDK,EAAO,OAAS,GAClBG,EAAaH,CAAM,EACnBzB,EAAa,qBAAqByB,EAAO,eAAe,EACxDE,IACIF,EAAO,OAAS,KAClBvB,EACE,+DACV,EACQM,EAAgB,EAAK,GAGvBU,MAEAhB,EAAW,wBAAwB,EACnCM,EAAgB,EAAK,EAExB,OAAQS,EAAP,CACA,QAAQ,MAAM,yBAA0BA,CAAK,EAC7Cf,EAAW,oCAAoC,CACnD,QAAY,CACRE,EAAgB,MAAM,QAAU,OAChCG,EAAiB,MAAM,QAAU,MAClC,CACH,CAAC,EAED,SAASmB,EAAcD,EAAQ,CAC7BtB,EAAiB,UAAY,GAC7ByB,EAAaH,CAAM,CACrB,CAEA,SAASG,EAAaH,EAAQ,CAC5B,MAAMI,EAAW,SAAS,yBAC1BJ,EAAO,QAAQK,GAAS,CACtB,KAAM,CACJ,cAAAC,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,EAAGP,EACEQ,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAU,IAAI,YAAY,EACpCA,EAAU,UAAY;AAAA,uBACHP,4CAAwDE;AAAA,4BACnDD,WAAsBC;AAAA,2CACPC,aAAiBC,gBAAoBC,iBAAwBC;AAAA;AAAA,UAGpGR,EAAS,YAAYS,CAAS,CAClC,CAAG,EACDnC,EAAiB,YAAY0B,CAAQ,EAErCP,GAAsBG,EAAO,MAC/B,CAEA,IAAIc,EAAW,KAEf,SAASZ,GAAqB,CACxBY,GACFA,EAAS,QAAO,EAElBA,EAAW,IAAIC,EAAe,YAAY,CAC5C"}